{% extends 'homepage.html' %}

{% block user %}

<div class="row">
    <div class="column middle" style="background-color:#142d4c;">
        <h2>Auction Won</h2>
        <div id="auction-history">
            <!-- Auction history will be loaded here -->
        </div>
    </div>
    <div class="column right" style="background-color:#5262df;">
      <h2>Auction Created</h2>
        <div id="auctions-created">
        <!-- Auction history will be loaded here -->
        </div>
    </div>
</div>

<script>
    // JavaScript function to update auction history
    function updateAuctionHistory() {
        fetch('/auction-history')
            .then(response => response.json())
            .then(data => {
                const historyElement = document.getElementById('auction-history');
                historyElement.innerHTML = ''; // Clear existing content

                data.forEach(entry => {
                    historyElement.innerHTML += `<div class="auction-entry">Auction Item ${entry.item_id}: $${entry.bid} by ${entry.bidder}</div>`;
                });
            });
    }
    function auctionCreated() {
        fetch('/auctions-created')
            .then(response => response.json())
            .then(data => {
                console.log("data: ", data)
                const createdElement = document.getElementById('auctions-created');
                createdElement.innerHTML = ''; // Clear existing content

                data.forEach(post => {
                    console.log("post", post)
                    // Update the following line if the structure of 'post' is different
                    createdElement.innerHTML += `<div><strong>${post.title}</strong>: ${post.detail}</div>`;
                });
            })
            .catch(error => {
                console.error('Error fetching auctions created:', error);
            });
    }

    // Call the functions on page load
    updateAuctionHistory();
    auctionCreated();
</script>

{% endblock %}